{% extends "layout.html" %}

{% block content %}

<div class="container-fluid">
    <h1 class="mt-5">
    {%- if edit == True -%}
        Edit Project Details
    {%- else -%}
        Project Details
    {%- endif -%}
    </h1>
    <div class="row onePadding">
        <div class="col-md-12 col-sm-12">
            <div class="container">
                {%-if edit == True%}
                    <script type="text/javascript" src = "{{ url_for('static', filename = 'js/editData.js') }}"></script>
                {%- endif -%}
                    <nav class="navbar navbar-expand-lg navbar-light justify-content-between bg-light">
                    <button class="btn btn-outline-primary"
                            type="button"
                            onclick="location.href='{{ url_for('page_projects')}}/{{ project['project_id']}}/edit'"
                {%-if edit == True%}
                    disabled
                {%- endif -%}
                    >Edit</button>
                    </nav>
                </div>
                <div class="container">
                    <div class="table-responsive">
                    <form  id="new-content-form" onsubmit="return editData('{{ url_for('.page_index') }}api/project/{{ project['project_id']}}')">
                        <table class="table ">
                         <thead class="thead-light"/>
                            <tr>
                                <th style="width: 16.66%">Title </th>
                                <td>
                                    {%- if edit == True -%}
                                        <input type="text" class="form-control" id="title" name="title" value="{{project['title']}}">
                                    {%- else -%}
                                    {{project['title']}}
                                    {%- endif -%}
                                </td>
                            </tr>
                            <tr>
                                <th>Project Code</th>
                                <td>
                                    {%- if edit == True -%}
                                        <input type="text" class="form-control" id="project_code" name="project_code" value="{{project['project_code']}}" disabled>
                                    {%- else -%}
                                        {{project['project_code']}}
                                    {%- endif -%}
                                </td>
                            </tr>
                            <tr>
                                <th>Status</th>
                                <td>
                                     {%- if edit == True -%}
                                        <input type="text" class="form-control" id="status" name="status" value="{{project['status']}}">
                                    {%- else -%}
                                        {{project['status']}}
                                    {%- endif -%}

                                </td>
                            </tr>
                            <tr>
                                <th>Current Location</th>
                                <td>
                                    {%- if edit == True -%}
                                        <input type="text" class="form-control" id="current_location" name="current_location" value="{{project['current_location']}}">
                                    {%- else -%}
                                        {{project['current_location']}}
                                    {%- endif -%}
                                </td>
                            </tr>
                            <tr>
                                <th rowspan="{{project['notes']|length + 1}}">Notes</th>

                                {%- for note in project['notes'] -%}
                                    <tr>
                                <td>{{ note['text'] }}</td>
                                    </tr>
                                {%- endfor -%}
                            </tr>
                            <tr>
                                <th rowspan="{{ project['objects']|length + 1 }}">Objects</th>
                                {%- for child_object in project['objects'] -%}
                                <tr><td><a href="{{ url_for('page_object')}}/{{child_object[0]}}"> {{child_object[1]}}</a></td></tr>
                                {%- endfor -%}
                            </tr>

                        </table>

                        {%- if edit == True -%}
                            <div id="success"
                                 class="modal fade bd-example-modal-sm"
                                 tabindex="-1"
                                 role="dialog"
                                 aria-labelledby="mySmallModalLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog modal-sm" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h1 id="status">Success</h1>
                                        </div>
                                        <div class="modal-body">
                                            <p id="changelog">Record Updated</p>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button"
                                                    class="btn btn-primary"
                                                    data-dismiss="modal"
                                                    onclick="location.href='{{ url_for('page_projects')}}/{{ project['project_id']}}'">
                                                Okay</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary" type="submit">Submit</button>
                            <button class="btn btn-secondary"
                                    type="button"
                                    onclick="location.href='{{ url_for('page_projects')}}/{{ project['project_id']}}'">Cancel</button>
                        {%- endif -%}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}